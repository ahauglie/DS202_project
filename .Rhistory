corrplot(cordata, col = palette) #dot graph
knitr::opts_chunk$set(echo = TRUE)
heatmap(x = cordata, col = palette, symm = TRUE) #heatmap
corrplot(cordata, col = palette) #dot graph
library("readxl")
library(dplyr)
library(tidyverse)
library(tidyverse)
library(ggplot2)
library(ggplot2)
library(plotly)
dat <- read_excel("ALL.xlsx")
dat <- select(dat, -Player2, -Player3)
dat <- mutate(dat, RBIAB = RBI / AB) ##Round these to .000 decimals if possible
##Runs batted in per at bat^
dat <- mutate(dat, HRAB = HR / AB)  ##Round these to .000 decimals if possible
##Home Runs per at bat^
dat <- mutate(dat, BABIP = (H - HR) / (AB - SO - HR + SF)) ##Round these to .000 decimals if possible
##Batting Average on Balls in Play^
dat$NP <- as.numeric(dat$NP) ##Cleaning the Data, changing column from character to Number
dat <- mutate(dat, NPPA = NP / PA) #ROUND TO 3 digits
##Number of pitches per plate appearance^
dat <- mutate(dat, NPAB = NP / AB) #ROUND TO 3 digits
##Number of Pitches per At bat per at bat^
dat <- mutate(dat, SOAB = SO / AB) #ROUND TO 3 digits
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = OPS)) + geom_histogram(binwidth = .005,color="Black", fill="light green") + xlab("On-Base + Slugging Percentage") + ggtitle("Histogram of OPS") + ylab("Count")
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
Posey <- dat[grepl("Posey,B", dat$Player),]
MeanBABIPposey <- mean(Posey$BABIP)
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white")  + geom_vline(xintercept = MeanBABIPposey, color = "Red")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .35, 125, "Buster Posey")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") # +
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .35, 125, label = "Buster Posey")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .35, 135, label = "Buster Posey")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .35, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .5, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .4, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .375, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white") +
geom_vline(xintercept = MeanBABIPposey, color = "Red") +
annotate("Text", .38, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") #+ annotate("Text", .38, 135, label = "Buster Posey's Average BABIP")## R_SQUARED
correlationMatrix2 <- select(dat, HRAB, SOAB)
cor(correlationMatrix2)
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") #+ annotate("Text", .38, 135, label = "Buster Posey's Average BABIP")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R   = .402 n/R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R   = .402 n/ R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R   = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R    = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R     = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R        = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R     = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R      = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = " R      = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "   R      = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "   R   = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "    R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "     R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .3625, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1125, .375, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1625, .375, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1425, .375, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1225, .375, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat") + annotate("Text", .1225, .370, label = "      R = .402 \n R^2 = .162")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
correlationMatrix2 <- select(dat, HRAB, SLG, NPPA, RBIAB)
cor(correlationMatrix2)
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
correlationMatrix2 <- select(dat, SLG, RBIAB)
cor(correlationMatrix2)
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage") + annotate("Text", .325, .525, label = "      R = .796 \n R^2 = .634")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage") + annotate("Text", .325, .55, label = "      R = .796 \n R^2 = .634")
View(dat)
RedSox <- dat[grepl("BOS", dat$Team),]
Yankees <- dat[grepl("NYY", dat$Team),]
Rivals <- full_join(RedSox, Yankees)
View(Rivals)
#This one has a slight positive correlation
ggplot(dat, aes(x = HRAB, y = NPAB)) + geom_smooth(method='lm') + geom_point() + xlab("Average Homeruns in an at Bat") + ggtitle("Relationship Between Average Number of Pitches in an at Bat to Batting Average") + ylab("Average Number of Pitches During an at Bat")## R_SQUARED
correlationMatrix2 <- select(dat, HRAB, NPAB)
cor(correlationMatrix2)
#This one proves the Null Hypothesis, that there is no Correlation
ggplot(dat, aes(x = AVG, y = NPAB)) + geom_smooth(method='lm') + geom_point() + xlab("Batting Average") + ggtitle("Relationship Between Average Number of Pitches in an at Bat to Batting Average") + ylab("Average Number of Pitches During an at Bat")## R_SQUARED
RedSox <- dat[grepl("BOS", dat$Team),]
Yankees <- dat[grepl("NYY", dat$Team),]
Rivals <- full_join(RedSox, Yankees)
RedSox <- dat[grepl("BOS", dat$Team),]
Yankees <- dat[grepl("NYY", dat$Team),]
Rivals <- full_join(RedSox, Yankees)
ggplot(Rivals, aes(x = HRAB)) + geom_histogram() + facet_wrap(~Team)
ggplot(Rivals, aes(x = HRAB)) + geom_histogram(binwidth = 5) + facet_wrap(~Team)
ggplot(Rivals, aes(x = HRAB)) + geom_histogram(binwidth = .05) + facet_wrap(~Team)
ggplot(Rivals, aes(x = HRAB)) + geom_histogram(binwidth = .01) + facet_wrap(~Team)
ggplot(Rivals, aes(x = HRAB)) + geom_boxplot() + facet_wrap(~Team)
ggplot(Rivals, aes(x = HRAB, y = AVG)) + geom_boxplot() + facet_wrap(~Team)
ggplot(Rivals, aes(x = 5, y = AVG)) + geom_boxplot() + facet_wrap(~Team)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot(color = "Team") + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot(color = Team) + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot(fill = Team) + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = Team)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = c("Red", "Blue"))) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = c("Red"))) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = c("Cardinal"))) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = c("DarkRed"))) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = "DarkRed")) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = "lightRed")) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG, fill = Team)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(x))
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(Team))
colors <- c("DarkRed", "Yellow")
colors <- c("DarkRed", "Yellow")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = colors)
colors <- c("DarkRed", "Yellow", "Blue")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = colors)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(x)))
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(Team)))
ggplot() + geom_boxplot(data = RedSox, x = HR, y = AVG) + geom_boxplot(data = Yankees, x = HR, y = AVG)
RedSox <- dat[grepl("BOS", dat$Team),]
Yankees <- dat[grepl("NYY", dat$Team),]
Rivals <- full_join(RedSox, Yankees)
ggplot() + geom_boxplot(data = RedSox, x = HR, y = AVG) + geom_boxplot(data = Yankees, x = HR, y = AVG)
View(Yankees)
ggplot() + geom_boxplot(data = RedSox, x = SLG, y = AVG) + geom_boxplot(data = Yankees, x = HR, y = AVG)
ggplot() + geom_boxplot(data = RedSox, x = AVG, y = AVG) + geom_boxplot(data = Yankees, x = HR, y = AVG)
ggplot() + geom_boxplot(data = RedSox, x = 5, y = AVG) + geom_boxplot(data = Yankees, x = HR, y = AVG)
ggplot() + geom_boxplot(data = RedSox, x = 5, y = 10) + geom_boxplot(data = Yankees, x = 3, y = 6)
jColors = c("Purple", "Green")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(Team)) + scale_fill_manual(values = jColors)
jColors = c("DarkRed", "Navy")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(Team)) + scale_fill_manual(values = jColors)
jColors = c("#BD3039", "#0C2340")
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = as.factor(Team)) + scale_fill_manual(values = jColors)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + scale_fill_manual(values = jColors)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = Team) + scale_fill_manual(values = jColors)
dat$RBIAB <- round(dat$RBIAB, digits 3)
dat$RBIAB <- round(dat$RBIAB, digits = 3)
View(dat)
dat$HRAB <- round(dat$HRAB, digits = 3)
dat$BABIP <- round(dat$BABIP, digits = 3)
##Home Runs per at bat^
dat <- mutate(dat, BABIP = (H - HR) / (AB - SO - HR + SF))
dat$BABIP <- round(dat$BABIP, digits = 3)
dat$NPPA <- round(dat$NPPA, digits = 3)
dat$NPAB <- round(dat$NPAB, digits = 3)
dat$SOAB <- round(dat$SOAB, digits = 3)
dat$NPAB <- dat$NPAB / 10
##Number of pitches per plate appearance^
dat <- mutate(dat, NPAB = NP / AB)
dat$NPAB <- round(dat$NPAB, digits = 3)
dat$NPAB2 <- dat$NPAB / 10
dat$NPAB2 <- round(dat$NPAB2, digits = 3)
##Number of Pitches per At bat per at bat^
dat <- mutate(dat, SOAB = SO / AB)
dat$SOAB <- round(dat$SOAB, digits = 3)
correlationMatrix3 <- select(dat, SLG, RBIAB, NPAB2)
cor(correlationMatrix3)
str(dat)
correlationMatrix3 <- select(dat, SLG, RBIAB, NPAB2)
cor(correlationMatrix3)
str(dat)
correlationMatrix3 <- select(dat, SLG, RBIAB)
cor(correlationMatrix3)
dat$NPAB <- round(dat$NPAB, digits = 3)
##Number of Pitches per At bat per at bat^
dat <- mutate(dat, SOAB = SO / AB)
dat$SOAB <- round(dat$SOAB, digits = 3)
correlationMatrix3 <- select(dat, SLG, RBIAB)
cor(correlationMatrix3)
cor(correlationMatrix3, use = "complete.obs")
correlationMatrix3 <- select(dat, SLG, RBIAB)
cor(correlationMatrix3, use = "complete.obs")
cor(correlationMatrix3, use = "na.or.complete")
cor(correlationMatrix3, use = "everything")
correlationMatrix3 <- select(dat, SLG, RBIAB)
cor(correlationMatrix3, use = "everything")
correlationMatrix3 <- select(dat, SLG, RBIAB, NPPA)
cor(correlationMatrix3, use = "everything")
cor(correlationMatrix3, use = "complete.obs")
correlationMatrix3 <- select(dat, SLG, RBIAB, NPPA, HR, HRAB)
cor(correlationMatrix3, use = "complete.obs")
correlationMatrix3 <- select(dat, SLG, RBIAB)
cor(correlationMatrix3, use = "complete.obs")
cordata <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, AO, SO, RBI, BB, XBH, NPPA, SB)
cordata <- cor(cordata, use = "complete.obs")
cordata.rcorr = rcorr(as.matrix(cordata))
library("Hmisc")
library(corrplot)
cordata <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, AO, SO, RBI, BB, XBH, NPPA, SB)
cordata <- cor(cordata, use = "complete.obs")
cordata.rcorr = rcorr(as.matrix(cordata))
cordata.rcorr
palette = colorRampPalette(c("blue", "yellow", "red")) (20)
corrplot(cordata, col = palette) #dot graph
cordata <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, AO, SO, RBI, BB, XBH, NPPA, SB)
ggplot(Rivals, aes(x = HR, y = AVG)) + geom_boxplot() + facet_wrap(~Team) + xlab("Average Home Runs Hit in a Season") + ylab("Batting Average") + ggtitle("Rivaly Between the Boston Red Sox and New York Yankees") + aes(fill = Team) + scale_fill_manual(values = jColors)
dat3 <- select(dat2, -AVG)
dat3 <- distinct(dat3)  #ROUND TO 3 digits
dat2 <- dat
dat2%>%
select(Pos, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Pos) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
ggplot(dat2, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="goldenrod2") + xlab("Batting Average") + ggtitle("Histogram of Batting Average by Position") + ylab("Count") + facet_wrap(~Pos) + geom_vline(aes(xintercept = MEANAVG))
ggplot(dat2, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="goldenrod2") + xlab("Batting Average") + ggtitle("Histogram of Batting Average by Position") + ylab("Count") + facet_wrap(~Pos) + geom_vline(aes(xintercept = MEANAVG))
dat3 <- select(dat2, -AVG)
dat3 <- distinct(dat3)  #ROUND TO 3 digits
View(dat3)
dat3$NPAB <- round(dat3$MEANAVG, digits = 3)
dat3$NPAB <- round(dat3$MEANAVG, digits = 3)
dat3$MEANAVG <- round(dat3$MEANAVG, digits = 3)
dat6 <- select(dat5, -AVG)
dat6 <- distinct(dat6)  #ROUND TO 3 digits
dat5 <- dat
dat5%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Team) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat5
dat6 <- select(dat5, -AVG)
dat6 <- distinct(dat6)  #ROUND TO 3 digits
dat6$MEANAVG <- round(dat6$MEANAVG, digits = 3)
head(dat6, 10)
dat7 <- datx
dat7%>%
select(Team, HRAB) %>%
mutate(HRAB = ifelse(HRAB == -9999, NA, HRAB)) %>%
group_by(Team) %>%
mutate(MeanHR = mean(HRAB, na.rm = T)) -> dat7
dat7 <- dat
dat7%>%
select(Team, HRAB) %>%
mutate(HRAB = ifelse(HRAB == -9999, NA, HRAB)) %>%
group_by(Team) %>%
mutate(MeanHR = mean(HRAB, na.rm = T)) -> dat7
dat8 <- select(dat7, -HRAB)
dat8 <- distinct(dat4)  #ROUND TO 3 digits
dat8 <- distinct(dat8)  #ROUND TO 3 digits
dat8$MeanHR <- round(dat8$MeanHR, digits = 3)
View(dat8)
head(dat4, 10)
head(dat8, 10)
head(dat6, 10)
head(dat4, 5)
dat4 <- dat4[order(dat4$MeanHR, decreasing = TRUE),]
head(dat4, 5)
dat7%>%
select(Team, HRAB) %>%
mutate(HRAB = ifelse(HRAB == -9999, NA, HRAB)) %>%
group_by(Team) %>%
mutate(MeanHR = mean(HRAB, na.rm = T)) -> dat7
dat8 <- select(dat7, -HRAB)
dat8 <- distinct(dat8)  #ROUND TO 3 digits
dat8$MeanHR <- round(dat8$MeanHR, digits = 3)
head(dat8, 10)
dat8 <- dat8[order(dat4$MeanHR, decreasing = TRUE),]
dat8 <- dat8[order(dat8$MeanHR, decreasing = TRUE),]
head(dat8, 5)
dat8 <- dat8[order(dat8$MeanHR, decreasing = TRUE),]
head(dat8, 5)
head(dat8, 33)
head(dat8, 34)
head(dat8, 33)
library(readxl)
library(XQuartz)
install.packages(XQuartz)
install.packages(XQuartz())
Stadiums <- read_excel("StadiumLocations.xlsx")
View(Stadiums)
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = OPS)) + geom_histogram(binwidth = .005,color="Black", fill="light green") + xlab("On-Base + Slugging Percentage") + ggtitle("Histogram of OPS") + ylab("Count")
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage") + annotate("Text", .325, .55, label = "      R = .796 \n R^2 = .634")
correlationMatrix3 <- select(dat, RBI, SLG)
cor(correlationMatrix3)
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
dat2 <- dat
dat2%>%
select(Pos, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Pos) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
ggplot(dat2, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="goldenrod2") + xlab("Batting Average") + ggtitle("Histogram of Batting Average by Position") + ylab("Count") + facet_wrap(~Pos) + geom_vline(aes(xintercept = MEANAVG))
ggplot(dat2, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="goldenrod2") + xlab("Batting Average") + ggtitle("Histogram of Batting Average by Position") + ylab("Count") + facet_wrap(~Pos) + geom_vline(aes(xintercept = MEANAVG))
dat3 <- select(dat2, -AVG)
dat3 <- distinct(dat3)  #ROUND TO 3 digits
dat3$MEANAVG <- round(dat3$MEANAVG, digits = 3)
head(dat3, 10)
head(dat3, 11)
dat5 <- dat
dat5%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Team) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat5
dat6 <- select(dat5, -AVG)
dat6 <- distinct(dat6)
dat6$MEANAVG <- round(dat6$MEANAVG, digits = 3)
head(dat6, 10)
head(dat6, 10)
Albert <- dat[grepl("Pujols,A", dat$Player),]
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black")
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", .325, .55, label = "Decided to leave ALL his fans and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
##annotate("Text", .325, .55, label = "Decided to leave ALL his fans and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
##annotate("Text", .325, .55, label = "Decided to leave ALL his fans and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black")
##annotate("Text", .325, .55, label = "Decided to leave ALL his fans and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
##annotate("Text", 2010, 130, label = "Decided to leave ALL his fans \n and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2010, 130, label = "Decided to leave ALL his fans \n and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013, 130, label = "Decided to leave ALL his fans \n and leave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013, 130, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2014, 130, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.5, 130, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.3, 135, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.4, 135, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.4, 135, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels. \nAll Stats Plummit")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.4, 130, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels. \nAll Stats Plummit")
ggplotly(a)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black") +
annotate("Text", 2013.5, 130, label = "Decided to leave ALL his fans and \nleave St. Louis and head to the Angels. \nAll Stats Plummit")
ggplotly(a)
