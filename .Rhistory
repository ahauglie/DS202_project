library(ggplot2)
library(dplyr)
library(tidyverse)
library(plyr)
library(readxl)
library(ggrepel)
topDogsFull <- readxl::read_xlsx('KIB - Best in Show (public).xlsx', sheet='Best in show full sheet', range = cell_rows(1:88))
topDogsFull$intelligence<- revalue(topDogsFull$intelligence, c("Above average" = "Clever", "Average" = "Dumb", "Brightest" = "Clever", "Excellent" = "Clever", "Fair" = "Dumb", "Lowest" = "Dumb"))
levels(topDogsFull$Size) <- c("small", "medium", "large")
topDogsFull$Size <- as.factor(topDogsFull$Size)
levels(topDogsFull$Size)
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score")
levels(topDogsFull$Size)
topDogsFull$Size <- as.factor(topDogsFull$Size)
levels(topDogsFull$Size)
topDogsFull$Size <- factor(topDogsFull$Size, levels = c("small", "medium", "large"))
levels(topDogsFull$Size)
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score")
knitr::opts_chunk$set(echo = TRUE)
head(dat4, 5)
library("readxl")
library(dplyr)
library(tidyverse)
library(ggplot2)
dat <- read_excel("ALL.xlsx")
dat <- select(dat, -Player2, -Player3)
dat <- mutate(dat, RBIAB = RBI / AB) ##Round these to .000 decimals if possible
##Runs batted in per at bat^
dat <- mutate(dat, HRAB = HR / AB)  ##Round these to .000 decimals if possible
##Home Runs per at bat^
dat <- mutate(dat, BABIP = (H - HR) / (AB - SO - HR + SF)) ##Round these to .000 decimals if possible
##Batting Average on Balls in Play^
dat$NP <- as.numeric(dat$NP) ##Cleaning the Data, changing column from character to Number
dat <- mutate(dat, NPPA = NP / PA) #ROUND TO 3 digits
##Number of pitches per plate appearance^
dat <- mutate(dat, NPAB = NP / AB) #ROUND TO 3 digits
##Number of Pitches per At bat per at bat^
dat <- mutate(dat, SOAB = SO / AB) #ROUND TO 3 digits
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = OPS)) + geom_histogram(binwidth = .005,color="Black", fill="light green") + xlab("On-Base + Slugging Percentage") + ggtitle("Histogram of OPS") + ylab("Count")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
dat2 <- dat
dat2%>%
select(Pos, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Pos) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
ggplot(dat2, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="goldenrod2") + xlab("Batting Average") + ggtitle("Histogram of Batting Average by Position") + ylab("Count") + facet_wrap(~Pos) + geom_vline(aes(xintercept = MEANAVG))
dat3 <- select(dat2, -AVG)
dat3 <- distinct(dat3)  #ROUND TO 3 digits
head(dat3, 10)
Albert <- dat[grepl("Pujols,A", dat$Player),]
ggplot(Albert, aes(x = Year)) +
geom_line(Albert, aes( y = AVG), color = "blue") +
geom_line(Albert, aes( y = SLG), color = "red") +
geom_line(Albert, aes( y = OPS), color = "purple") +
geom_line(Albert, aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat")## R_SQUARED
Giants <- dat[grepl("SF", dat$Team),]
Padres <- dat[grepl("SD", dat$Team),]
Rivals <- full_join(Padres, Giants)
#This one proves the Null Hypothesis, that there is no Correlation
ggplot(dat, aes(x = AVG, y = NPAB)) + geom_smooth(method='lm') + geom_point() + xlab("Batting Average") + ggtitle("Relationship Between Average Number of Pitches in an at Bat to Batting Average") + ylab("Average Number of Pitches During an at Bat")## R_SQUARED
#This one has a slight positive correlation
ggplot(dat, aes(x = HRAB, y = NPAB)) + geom_smooth(method='lm') + geom_point() + xlab("Average Homeruns in an at Bat") + ggtitle("Relationship Between Average Number of Pitches in an at Bat to Batting Average") + ylab("Average Number of Pitches During an at Bat")## R_SQUARED
ggplot(dat, aes(x = BABIP)) + geom_histogram()
Posey <- dat[grepl("Posey,B", dat$Player),]
View(Posey)
mean(Posey$BABIP)
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(mean(Posey$BABIP))
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(aes(mean(Posey$BABIP))
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(aes(mean(Posey$BABIP)))
MeanBABIP <- mean(Posey$BABIP)
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(aes(MeanBABIP))
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(aes(xintercept = MeanBABIP))
ggplot(dat, aes(x = BABIP)) + geom_histogram() + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP, color = Blue)) + geom_histogram() + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = lightblue)) + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "lightblue"")) + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
Posey <- dat[grepl("Posey,B", dat$Player),]
MeanBABIP <- mean(Posey$BABIP)
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "lightblue")) + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "lightblue")) # + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "red)) # + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "red")) # + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "red")) # + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "white")) # + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "white"))  + geom_vline(aes(xintercept = MeanBABIP, color = "Red"))
MeanBABIPposey <- mean(Posey$BABIP)
MeanBABIPalbert <- mean(Albert$BABIP)
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "white"))  + geom_vline(aes(xintercept = MeanBABIalbert, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "white"))  + geom_vline(aes(xintercept = MeanBABIPalbert, color = "Red"))
View(Albert)
ggplot(Albert, aes(x = Year)) +
geom_line(Albert, aes( y = AVG), color = "blue") +
geom_line(Albert, aes( y = SLG), color = "red") +
geom_line(Albert, aes( y = OPS), color = "purple") +
geom_line(Albert, aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year")
View(dat)
correlationMatrix <- select(dat, AVG, OBP, HRAB)
View(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP)
View(correlationMatrix)
cor(correlationMatrix)
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = OPS)) + geom_histogram(binwidth = .005,color="Black", fill="light green") + xlab("On-Base + Slugging Percentage") + ggtitle("Histogram of OPS") + ylab("Count")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
ggplot(dat, aes(x = AVG)) + geom_histogram(binwidth = .002,color="Black", fill="light blue") + xlab("Batting Average") + ggtitle("Histogram of Batting Average") + ylab("Count")
ggplot(dat, aes(x = OPS)) + geom_histogram(binwidth = .005,color="Black", fill="light green") + xlab("On-Base + Slugging Percentage") + ggtitle("Histogram of OPS") + ylab("Count")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat")## R_SQUARED
#This one proves the Null Hypothesis, that there is no Correlation
ggplot(dat, aes(x = AVG, y = NPAB)) + geom_smooth(method='lm') + geom_point() + xlab("Batting Average") + ggtitle("Relationship Between Average Number of Pitches in an at Bat to Batting Average") + ylab("Average Number of Pitches During an at Bat")## R_SQUARED
dat3%>%
select(Team, HRAB) %>%
mutate(HRAB = ifelse(HRAB == -9999, NA, HRAB)) %>%
group_by(Team) %>%
mutate(MeanHR = mean(HRAB, na.rm = T)) -> dat3
dat3 <- dat
dat3%>%
select(Team, HRAB) %>%
mutate(HRAB = ifelse(HRAB == -9999, NA, HRAB)) %>%
group_by(Team) %>%
mutate(MeanHR = mean(HRAB, na.rm = T)) -> dat3
dat4 <- select(dat3, -HRAB)
ggplot(dat, aes(x = BABIP,)) + geom_histogram(aes(color = "black", fill = "white"))  + geom_vline(aes(xintercept = MeanBABIPposey, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white")  + geom_vline(aes(xintercept = MeanBABIPposey, color = "Red"))
ggplot(dat, aes(x = BABIP,)) + geom_histogram(color = "black", fill = "white")  + geom_vline(xintercept = MeanBABIPposey, color = "Red")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
Trout <- dat[grepl("Trout,M", dat$Player),]
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year") +
geom_vline(xintercept = 2011, color = "Red")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2011, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = HRAB), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = RBIAB), color = "red") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = OPS), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = SLG), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = BABIP), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = BABIP), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_curve(aes( y = RBIAB), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = BABIP), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
Rivals <- full_join(Padres, Giants)
Padres <- dat[grepl("SD", dat$Team),]
Giants <- dat[grepl("SF", dat$Team),]
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + annotate("Text", x = 1.2, y = 1, label = "dick" )
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + annotate("Text", x = 1.2, y = 160, label = "dick" )
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + annotate("Text", x = 1, y = 160, label = "Data Score is Calculated by Using Intelligence, " )
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + annotate("Text", x = 1.2, y = 160, label = "Data Score is Calculated by Using Intelligence, " )
?subtitle
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + subtitle("Text", label =  "Data Score is Calculated by Using Intelligence, " )
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Location")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using Intelligence, Costs, Longevity, Grooming, Ailments, and Appetite)
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using Intelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") #+ labs(subtitle="Data Score is Calculated using Intelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using Intelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using \n Intelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using \nIntelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(topDogsFull, aes(x = `datadog score`, y = Popularity, color = Category, shape = intelligence, label = Breed)) + geom_point(aes(size = Size)) + geom_text_repel(segment.size = .1, size = 2, color = "black") + xlab("Data Score") + ggtitle("Top Dogs with Popularity and Data Score") + labs(subtitle="Data Score is Calculated using: \nIntelligence, Costs, Longevity, Grooming, Ailments, and Appetite")
ggplot(dat, aes(x = HRAB, y = NPPA)) + geom_point() + geom_smooth(method='lm',formula=y~x) ## R_SQUARED
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = SB), color = "purple") +
geom_line(aes( y = R), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = SB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Percentages") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SB), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SB), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year") +
geom_vline(xintercept = 2018, color = "Red")
ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
ggplot(dat, aes(x = HRAB, y = SOAB)) + geom_smooth(method='lm') + geom_point() + xlab("Home Runs Per at Bat") + ggtitle("Homerun Hitters and Strike Out Percentages") + ylab("Strike outs Per at Bat")## R_SQUARED
Stadiums <- read_excel("StadiumLocations.xlsx")
View(Stadiums)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS )
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, NPPA )
cor(correlationMatrix)
View(dat)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, NPAB)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, NPPA/10)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, NPPA)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, NP)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, R)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, HR)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, HR, SO, RBI, BB, IBB)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, HRAB, BABIP, RBIAB, OPS, SOAB, HR, SO, RBI, BB, IBB, XBH)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, SLG, HRAB, BABIP, RBIAB, OPS, SOAB, HR, SO, RBI, BB, IBB, XBH)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, SO, RBI, BB, IBB, XBH)
cor(correlationMatrix)
correlationMatrix <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, SO, RBI, BB, XBH)
correlationMatrix <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, SO, RBI, BB, XBH)
cor(correlationMatrix)
library(plotly)
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Red")
plotly(a)
ggplotly(a)
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SB), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year") +
geom_vline(xintercept = 2018, color = "Black")
a <- ggplot(Albert, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SO), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Albert Pujols's Career mapped by Year") +
geom_vline(xintercept = 2010, color = "Black")
ggplotly(a)
b <- ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = AVG), color = "blue") +
geom_line(aes( y = BABIP), color = "red") +
geom_line(aes( y = HRAB), color = "purple") +
geom_line(aes( y = RBIAB), color = "Orange") +
ylab("Averages") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year")
ggplotly(b)
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SB), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year") +
geom_vline(xintercept = 2018, color = "Black")
ggplot(Trout, aes(x = Year)) +
geom_line(aes( y = HR), color = "blue") +
geom_line(aes( y = SB), color = "red") +
geom_line(aes( y = BB), color = "purple") +
geom_line(aes( y = RBI), color = "Orange") +
ylab("Totals By Category") +
xlab("Year") +
ggtitle("Mike Trout's Career mapped by Year") +
geom_vline(xintercept = 2017, color = "Black")
ggplot(dat, aes(x = RBIAB, y = SLG)) + geom_point(color = 'coral2') + geom_smooth(method='lm',formula=y~x) + xlab("RBI per At bat") + ggtitle("Relationship between Slugging Percentage and RBI's per At Bat") + ylab("Slugging Percentage")## R_SQUARED
correlationMatrix2 <- select(HRAB, SOAB)
correlationMatrix2 <- select(dat, HRAB, SOAB)
cor(correlationMatrix)
cor(correlationMatrix2)
correlationMatrix3 <- select(RBI, SLG)
cor(correlationMatrix3)
correlationMatrix3 <- select(RBI, SLG)
correlationMatrix3 <- select(dat, RBI, SLG)
cor(correlationMatrix3)
head(dat4, 5)
head(dat3, 10)
dat2%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Pos) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
dat2%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Pos) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
dat2%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Team) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
dat2 <- dat
dat2%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Team) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat2
dat5 <- dat
dat5%>%
select(Team, AVG) %>%
mutate(AVG = ifelse(AVG == -9999, NA, AVG)) %>%
group_by(Team) %>%
mutate(MEANAVG = mean(AVG, na.rm = T)) -> dat5
dat6 <- select(dat5, -AVG)
dat6 <- distinct(dat6)  #ROUND TO 3 digits
View(dat6)
head(dat3, 10)
head(dat6, 10)
Stadiums <- read_excel("StadiumLocations.xlsx")
states <- map_data("state")
ggplot(states, aes(x=long, y=lat))+geom_polygon(aes(group=group))
ggplot(states, aes(x=long, y=lat))+geom_polygon(aes(group=group))+geom_point(aes(x=LONGITUD, y=LATITUDE), data=acc %>% filter(LONGITUD <0 & LONGITUD> -130), size=0.02, color="white")
install.packages("Hmisc")
install.packages("Hmisc")
library("Hmisc")
install.packages("corrplot")
install.packages("corrplot")
library(corrplot)
cordata <- select(dat, AVG, OBP, SLG, BABIP, OPS, HR, AO, SO, RBI, BB, XBH)
cordata <- cor(cordata)
cordata.rcorr = rcorr(as.matrix(cordata))
cordata.rcorr
palette = colorRampPalette(c("blue", "yellow", "red")) (20)
corrplot(cordata, col = palette) #dot graph
heatmap(x = cordata, col = palette, symm = TRUE) #heatmap
corrplot(cordata, col = palette) #dot graph
